{"version":3,"sources":["../../../src/plugins/uploader/file_uploader.js"],"names":[],"mappings":";;;;;AAKA,YAAY,CAAC;;AAEb,IAAM,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;;AAE/B,MAAM,CAAC,OAAO,GAAG,UAAC,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAK;;AAE5C,SAAK,CAAC,GAAG,CAAC,KAAK,EAAE,UAAC,IAAI,EAAE,YAAY,EAAK;;AAErC,YAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;AAC/B,YAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;;AAErB,YAAI,SAAS,YAAA,CAAC;AACd,YAAI;AACA,qBAAS,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC;SAC1D,CACD,OAAO,CAAC,EAAE;AACN,qBAAS,GAAG,IAAI,CAAC,IAAI,YAAY,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC;SACrE;;AAED,YAAM,OAAO,GAAG,QAAQ,GAAG,IAAI,CAAC,YAAY,GAAG,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,EAAE,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,SAAS,GAAG,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;;AAE5H,gBAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,OAAO,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC,EAAE,YAAY,CAAC,CAAC;KACnF,EAAE,QAAQ,CAAC,CAAC;CAChB,CAAC","file":"file_uploader.js","sourcesContent":["/**\n *\n * Updated by uur on 12/01/16.\n */\n\n\"use strict\";\n\nconst Async = require(\"async\");\n\nmodule.exports = (forklift, files, callback) => {\n\n    Async.map(files, (file, eachCallback) => {\n\n        const instance = file.instance;\n        const key = file.key;\n\n        let extension;\n        try {\n            extension = instance[key][\"filename\"].split(\".\").pop();\n        }\n        catch (e) {\n            extension = file.kind instanceof Array ? file.kind[0] : file.kind;\n        }\n\n        const s3_path = \"files/\" + file.uploadFolder + \"/\" + file.instance.id + \"_\" + file.key + \".\" + extension + \"?\" + Date.now();\n\n        forklift.upload(file.instance[key].path, s3_path, {remove: true}, eachCallback);\n    }, callback);\n};"]}