{"version":3,"sources":["../../../src/plugins/uploader/file_uploader.js"],"names":[],"mappings":";;;;;AAKA;;AAEA,IAAM,QAAQ,QAAQ,OAAR,CAAR;AACN,IAAM,OAAO,QAAQ,aAAR,CAAP;;AAEN,OAAO,OAAP,GAAiB,UAAC,QAAD,EAAW,QAAX,EAAqB,KAArB,EAA4B,QAA5B,EAAyC;;AAEtD,UAAM,IAAN,CAAW,KAAX,EAAkB,UAAC,IAAD,EAAO,YAAP,EAAwB;;AAEtC,YAAM,gBAAgB,SAAS,KAAK,WAAL,CAAT,EAA4B,MAA5B,CAAhB,CAFgC;AAGtC,YAAM,0BAAwB,KAAK,WAAL,UAAqB,SAAS,GAAT,SAAgB,KAAK,KAAK,MAAL,CAAL,UAAsB,KAAK,KAAL,UAAe,KAAK,GAAL,EAAlG,CAHgC;;AAKtC,iBAAS,MAAT,CAAgB,aAAhB,EAA+B,YAA/B,EAA6C,UAAC,KAAD,EAAQ,GAAR,EAAgB;;AAEzD,gBAAI,KAAJ,EAAW;AACP,uBAAO,aAAa,KAAb,CAAP,CADO;aAAX;;AAIA,qBAAS,KAAK,WAAL,CAAT,IAA8B,GAA9B,CANyD;AAOzD,mBAAO,cAAP,CAPyD;SAAhB,CAA7C,CALsC;KAAxB,EAef,QAfH,EAFsD;CAAzC","file":"file_uploader.js","sourcesContent":["/**\n *\n * Updated by uur on 12/01/16.\n */\n\n\"use strict\";\n\nconst Async = require(\"async\");\nconst Slug = require(\"speakingurl\");\n\nmodule.exports = (forklift, instance, files, callback) => {\n\n    Async.each(files, (file, eachCallback) => {\n\n        const localFilePath = instance[file[\"schemaKey\"]][\"path\"];\n        const remoteFolder = `files/${file[\"schemaKey\"]}/${instance._id}-${Slug(file[\"name\"])}.${file[\"ext\"]}?${Date.now()}`;\n\n        forklift.upload(localFilePath, remoteFolder, (error, url) => {\n\n            if (error) {\n                return eachCallback(error);\n            }\n\n            instance[file[\"schemaKey\"]] = url;\n            return eachCallback();\n        });\n\n    }, callback);\n};\n"]}