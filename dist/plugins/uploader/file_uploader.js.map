{"version":3,"sources":["../../../src/plugins/uploader/file_uploader.js"],"names":[],"mappings":";;;;;AAKA;;AAEA,IAAM,QAAQ,QAAQ,OAAR,CAAd;AACA,IAAM,OAAO,QAAQ,aAAR,CAAb;;AAEA,OAAO,OAAP,GAAiB,UAAC,QAAD,EAAW,QAAX,EAAqB,KAArB,EAA4B,QAA5B,EAAyC;;AAEtD,UAAM,IAAN,CAAW,KAAX,EAAkB,UAAC,IAAD,EAAO,YAAP,EAAwB;;AAEtC,YAAM,gBAAgB,SAAS,KAAK,WAAL,CAAT,EAA4B,MAA5B,CAAtB;AACA,YAAM,0BAAwB,KAAK,WAAL,CAAxB,SAA6C,SAAS,GAAtD,SAA6D,KAAK,KAAK,MAAL,CAAL,CAA7D,SAAmF,KAAK,KAAL,CAAzF;;AAEA,iBAAS,MAAT,CAAgB,aAAhB,EAA+B,YAA/B,EAA6C,EAAC,WAAW,IAAZ,EAA7C,EAAgE,UAAC,KAAD,EAAQ,GAAR,EAAgB;;AAE5E,gBAAI,KAAJ,EAAW;AACP,uBAAO,aAAa,KAAb,CAAP;AACH;;AAED,qBAAS,KAAK,WAAL,CAAT,IAA8B,GAA9B;AACA,mBAAO,cAAP;AACH,SARD;AAUH,KAfD,EAeG,QAfH;AAgBH,CAlBD","file":"file_uploader.js","sourcesContent":["/**\n *\n * Updated by uur on 12/01/16.\n */\n\n\"use strict\";\n\nconst Async = require(\"async\");\nconst Slug = require(\"speakingurl\");\n\nmodule.exports = (forklift, instance, files, callback) => {\n\n    Async.each(files, (file, eachCallback) => {\n\n        const localFilePath = instance[file[\"schemaKey\"]][\"path\"];\n        const remoteFolder = `files/${file[\"schemaKey\"]}/${instance._id}-${Slug(file[\"name\"])}.${file[\"ext\"]}`;\n\n        forklift.upload(localFilePath, remoteFolder, {timestamp: true}, (error, url) => {\n\n            if (error) {\n                return eachCallback(error);\n            }\n\n            instance[file[\"schemaKey\"]] = url;\n            return eachCallback();\n        });\n\n    }, callback);\n};\n"]}